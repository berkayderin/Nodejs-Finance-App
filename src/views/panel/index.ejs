<div
	x-data="{ 
	categoryModal: false,
	incomeModal: false,
	expenseModal: false,
	categoryForm: {
		name: '',
		description: ''
	},
	incomeForm: {
		name: '',
		amount: '',
		description: '',
		date: new Date().toISOString().split('T')[0],
	},
	expenseForm: {
		name: '',
		amount: '',
		description: '',
		date: new Date().toISOString().split('T')[0],
		categoryId: ''
	},
	categories: [],
	async getCategories() {
		try {
			const response = await fetch('/api/categories')
			const data = await response.json()
			this.categories = data
		} catch (error) {
			console.error('Kategoriler yüklenirken hata:', error)
		}
	},
	async submitCategory() {
		try {
			const response = await fetch('/api/categories', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(this.categoryForm)
			})
			if (response.ok) {
				this.categoryModal = false
				this.categoryForm = { name: '', description: '' }
				this.getCategories()
			}
		} catch (error) {
			console.error('Kategori eklenirken hata:', error)
		}
	},
	async submitIncome() {
		try {
			const response = await fetch('/api/incomes', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(this.incomeForm)
			})
			if (response.ok) {
				this.incomeModal = false
				this.incomeForm = {
					name: '',
					amount: '',
					description: '',
					date: new Date().toISOString().split('T')[0],
				}
			}
		} catch (error) {
			console.error('Gelir eklenirken hata:', error)
		}
	},
	async submitExpense() {
		try {
			const response = await fetch('/api/expenses', {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(this.expenseForm)
			})
			if (response.ok) {
				this.expenseModal = false
				this.expenseForm = {
					name: '',
					amount: '',
					description: '',
					date: new Date().toISOString().split('T')[0],
					categoryId: ''
				}
			}
		} catch (error) {
			console.error('Gider eklenirken hata:', error)
		}
	}
}"
	x-init="getCategories"
>
	<div class="bg-white shadow rounded-lg">
		<div class="px-4 py-5 sm:p-6">
			<h2 class="text-lg font-medium leading-6 text-gray-900">Hoş Geldiniz!</h2>
			<div class="mt-5">
				<div class="rounded-md bg-primary-50 p-4">
					<div class="flex">
						<div class="ml-3">
							<h3 class="text-sm font-medium text-primary-800">Hızlı İşlemler</h3>
							<div class="mt-4 flex flex-wrap gap-4">
								<button
									@click="categoryModal = true"
									class="inline-flex items-center rounded-md bg-primary-700 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600"
								>
									Yeni Kategori
								</button>
								<button
									@click="incomeModal = true"
									class="inline-flex items-center rounded-md bg-primary-700 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600"
								>
									Yeni Gelir
								</button>
								<button
									@click="expenseModal = true"
									class="inline-flex items-center rounded-md bg-primary-700 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-600 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600"
								>
									Yeni Gider
								</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Kategori Modal -->
	<div
		x-show="categoryModal"
		class="relative z-10"
		aria-labelledby="modal-title"
		role="dialog"
		aria-modal="true"
		x-cloak
	>
		<div
			x-show="categoryModal"
			x-transition:enter="ease-out duration-300"
			x-transition:enter-start="opacity-0"
			x-transition:enter-end="opacity-100"
			x-transition:leave="ease-in duration-200"
			x-transition:leave-start="opacity-100"
			x-transition:leave-end="opacity-0"
			class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
		></div>

		<div class="fixed inset-0 z-10 overflow-y-auto">
			<div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
				<div
					x-show="categoryModal"
					x-transition:enter="ease-out duration-300"
					x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
					x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
					x-transition:leave="ease-in duration-200"
					x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
					x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
					class="relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"
				>
					<div>
						<h3 class="text-lg font-medium leading-6 text-gray-900 mb-4">Yeni Kategori</h3>
						<form @submit.prevent="submitCategory">
							<div class="space-y-4">
								<div>
									<label for="name" class="block text-sm font-medium text-gray-700">Kategori Adı</label>
									<input
										type="text"
										name="name"
										id="name"
										x-model="categoryForm.name"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									/>
								</div>
								<div>
									<label for="description" class="block text-sm font-medium text-gray-700">Açıklama</label>
									<textarea
										name="description"
										id="description"
										x-model="categoryForm.description"
										rows="3"
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									></textarea>
								</div>
							</div>
							<div class="mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3">
								<button
									type="submit"
									class="inline-flex w-full justify-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600 sm:col-start-2"
								>
									Kaydet
								</button>
								<button
									type="button"
									@click="categoryModal = false"
									class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:col-start-1 sm:mt-0"
								>
									İptal
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Gelir Modal -->
	<div x-show="incomeModal" class="relative z-10" aria-labelledby="modal-title" role="dialog" aria-modal="true" x-cloak>
		<div
			x-show="incomeModal"
			x-transition:enter="ease-out duration-300"
			x-transition:enter-start="opacity-0"
			x-transition:enter-end="opacity-100"
			x-transition:leave="ease-in duration-200"
			x-transition:leave-start="opacity-100"
			x-transition:leave-end="opacity-0"
			class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
		></div>

		<div class="fixed inset-0 z-10 overflow-y-auto">
			<div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
				<div
					x-show="incomeModal"
					x-transition:enter="ease-out duration-300"
					x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
					x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
					x-transition:leave="ease-in duration-200"
					x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
					x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
					class="relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"
				>
					<div>
						<h3 class="text-lg font-medium leading-6 text-gray-900 mb-4">Yeni Gelir</h3>
						<form @submit.prevent="submitIncome">
							<div class="space-y-4">
								<div>
									<label for="income-name" class="block text-sm font-medium text-gray-700">Gelir Adı</label>
									<input
										type="text"
										name="name"
										id="income-name"
										x-model="incomeForm.name"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
										placeholder="Gelir adını girin"
									/>
								</div>
								<div>
									<label for="income-amount" class="block text-sm font-medium text-gray-700">Tutar</label>
									<input
										type="number"
										step="0.01"
										name="amount"
										id="income-amount"
										x-model="incomeForm.amount"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									/>
								</div>
								<div>
									<label for="income-date" class="block text-sm font-medium text-gray-700">Tarih</label>
									<input
										type="date"
										name="date"
										id="income-date"
										x-model="incomeForm.date"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									/>
								</div>
								<div>
									<label for="income-description" class="block text-sm font-medium text-gray-700">Açıklama</label>
									<textarea
										name="description"
										id="income-description"
										x-model="incomeForm.description"
										rows="3"
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									></textarea>
								</div>
							</div>
							<div class="mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3">
								<button
									type="submit"
									class="inline-flex w-full justify-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600 sm:col-start-2"
								>
									Kaydet
								</button>
								<button
									type="button"
									@click="incomeModal = false"
									class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:col-start-1 sm:mt-0"
								>
									İptal
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Gider Modal -->
	<div
		x-show="expenseModal"
		class="relative z-10"
		aria-labelledby="modal-title"
		role="dialog"
		aria-modal="true"
		x-cloak
	>
		<div
			x-show="expenseModal"
			x-transition:enter="ease-out duration-300"
			x-transition:enter-start="opacity-0"
			x-transition:enter-end="opacity-100"
			x-transition:leave="ease-in duration-200"
			x-transition:leave-start="opacity-100"
			x-transition:leave-end="opacity-0"
			class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
		></div>

		<div class="fixed inset-0 z-10 overflow-y-auto">
			<div class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0">
				<div
					x-show="expenseModal"
					x-transition:enter="ease-out duration-300"
					x-transition:enter-start="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
					x-transition:enter-end="opacity-100 translate-y-0 sm:scale-100"
					x-transition:leave="ease-in duration-200"
					x-transition:leave-start="opacity-100 translate-y-0 sm:scale-100"
					x-transition:leave-end="opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"
					class="relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6"
				>
					<div>
						<h3 class="text-lg font-medium leading-6 text-gray-900 mb-4">Yeni Gider</h3>
						<form @submit.prevent="submitExpense">
							<div class="space-y-4">
								<div>
									<label for="expense-name" class="block text-sm font-medium text-gray-700">Gider Adı</label>
									<input
										type="text"
										name="name"
										id="expense-name"
										x-model="expenseForm.name"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
										placeholder="Gider adını girin"
									/>
								</div>
								<div>
									<label for="expense-amount" class="block text-sm font-medium text-gray-700">Tutar</label>
									<input
										type="number"
										step="0.01"
										name="amount"
										id="expense-amount"
										x-model="expenseForm.amount"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									/>
								</div>
								<div>
									<label for="expense-category" class="block text-sm font-medium text-gray-700">Kategori</label>
									<select
										id="expense-category"
										name="categoryId"
										x-model="expenseForm.categoryId"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									>
										<option value="">Kategori Seçin</option>
										<template x-for="category in categories" :key="category.id">
											<option :value="category.id" x-text="category.name"></option>
										</template>
									</select>
								</div>
								<div>
									<label for="expense-date" class="block text-sm font-medium text-gray-700">Tarih</label>
									<input
										type="date"
										name="date"
										id="expense-date"
										x-model="expenseForm.date"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									/>
								</div>
								<div>
									<label for="expense-description" class="block text-sm font-medium text-gray-700">Açıklama</label>
									<textarea
										name="description"
										id="expense-description"
										x-model="expenseForm.description"
										rows="3"
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-primary-500 focus:ring-primary-500 sm:text-sm"
									></textarea>
								</div>
							</div>
							<div class="mt-5 sm:mt-6 sm:grid sm:grid-flow-row-dense sm:grid-cols-2 sm:gap-3">
								<button
									type="submit"
									class="inline-flex w-full justify-center rounded-md bg-primary-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-primary-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary-600 sm:col-start-2"
								>
									Kaydet
								</button>
								<button
									type="button"
									@click="expenseModal = false"
									class="mt-3 inline-flex w-full justify-center rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50 sm:col-start-1 sm:mt-0"
								>
									İptal
								</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<style>
	[x-cloak] {
		display: none !important;
	}
</style>
